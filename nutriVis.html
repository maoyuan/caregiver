<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="css/lib/bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="css/lib/font-awesome.min.css"/>
	<link rel="stylesheet" type="text/css" href="css/lib/bootstrap-multiselect.css"/>
	<link rel="stylesheet" href="./css/lib/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="css/style.css"/>       
    <link href="css/lib/datepicker.css" rel="stylesheet">
    <link href="styles/main.css" rel="stylesheet" media="screen, projection">
    <link rel="stylesheet" type="text/css" href="css/lib/bootstrap.min.css"/>
    <link href="styles/transitions.css" rel="stylesheet" media="screen, projection">

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/lib/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/lib/bootstrap-multiselect.js"></script>
    

    
    <script type="text/javascript" src="scripts/modernizr.2.5.3.min.js"></script>
    <script type="text/javascript" src="scripts/utils.js"></script>
    <script type="text/javascript" src="scripts/custom_survey.js"></script>
    <script type="text/javascript" src="scripts/jquery.columnizer.min.js"></script>
    <script type="text/javascript" src="scripts/html5slider.js"></script>
    
    
    <link rel="stylesheet" type="text/css" href="css/lib/metricsgraphics.css"/>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.min.js' charset='utf-8'></script>
    <script src='js/lib/dist/metricsgraphics.min.js'></script> 
    
    
    
    <style>
        .vis-bg{
            bgcolor:red;
        }
        
        .move-down{
            margin-top: 45px;
        }
        
        #lineCharts{
            margin-top:50px;
            background-color:white !important;
        }
        
        .bg-white{
            background-color:white !important;
        }
        
        .float-left{
            float:left;
        }
        polyline{
            opacity: .3;
            stroke: black;
            stroke-width: 2px;
            fill: none;
        }
        svg {
            width: 100%;
            height: 100%;
        }
        
    </style>

	<title>CareFood</title>
</head>
<body>
    <div class="modal fade" id="calendar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Food Calendar</h4>
      </div>
      <div class="modal-body">
      <div class = "row">
        <div class = "col-md-6">
            <div class="dp6" data-date="12-02-2012" data-date-format="dd-mm-yyyy"></div>
        </div>
        <div class = "col-md-6">
            <div class = "radio">
                <label><input type = "radio" name = "opt" checked>breakfast</input></label>
            </div>
            <div class = "radio">
                <label><input type = "radio" name = "opt">lunch</input></label>
            </div>
            <div class = "radio">
                <label><input type = "radio" name = "opt">diner</input></label>
            </div>
        </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Save</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
        
      </div>
    </div>
    
	<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	    <div class="container-fluid">
	        <div class="navbar-header">
	            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
	                <span class="sr-only">Toggle navigation</span>
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	            </button>
	            <a class="navbar-brand" id="carefood"><h1>CareFood</h1></a>
	        </div>

	        <div class="collapse navbar-collapse bs-navbar-collapse">
	        	<ul class="nav navbar-nav navbar-right">
	    			<li>
	    				<a href="#"><span class="glyphicon glyphicon-home"></span> Home</a>
					</li>
	    			<li>
	    				<a href="#"><span class="glyphicon glyphicon-home"></span> Home</a>
					</li>
	    			<li>
	    				<a href="#"><span class="glyphicon glyphicon-home"></span> Home</a>
					</li>
				</ul>
	        </div>
	    </div>
	</div>

	<div id="lineCharts" style = "width:1422px;">

		<div class ="row bg-white" style = "width:1422px;">
        <div class="col-md-5 float-left">
            <div id="theArt">
                <div id="cube" class="show-front">
                  
                    <div class="front panel">
                      <div class="innerContainer">
                        <h2 style="text-align:center;">Calorie</h2>

                        <div id='calorie' class="move-down"></div>
                        <p class="show-buttons" style = "text-align:center;">  
                          <input type="button" class="show-back alignLeft" value="Fat" />
                          <input type="button" class="show-right" value="Carb" />
                          <input type="button" class="show-left alignRight" value="Protein" />            
                        </p>
                      </div>
                    </div>
                    <div class="back cf panel">
                      <div class="innerContainer">
                        <h2 style="text-align:center;">Fat</h2>
                        <div id='fat' class="move-down"></div>
                        <p class="show-buttons" style = "text-align:center;">
                          <input type="button" class="show-front alignLeft" value="Calorie" />
                          <input type="button" class="show-right" value="Carb" />
                          <input type="button" class="show-left alignRight" value="Protein" />
                        </p>
                      </div>
                    </div>
                    <div class="right cf panel">
                      <div class="innerContainer">
                        <h2 style="text-align:center;">Carbohydrate</h2>
                         <div id='surger' class="move-down"></div>
                       
                        <p class="show-buttons" style = "text-align:center;">
                          <input type="button" class="show-front alignLeft" value="Calorie" />
                          <input type="button" class="show-back" value="Fat" />
                          <input type="button" class="show-left alignRight" value="Protein" />
                        </p>
                      </div>
                    </div>
                    <div class="left cf panel">
                      <div class="innerContainer">
                        <h2 style="text-align:center;">Protein</h2>
                        <div id='protein' class="move-down"></div>
                        <p class="show-buttons" style = "text-align:center;">
                          <input type="button" class="show-front alignLeft" value="Calorie" />
                          <input type="button" class="show-back" value="Fat" />
                          <input type="button" class="show-right alignRight" value="Carb" />
                        </p>
                      </div>
                    </div>
                </div>
            </div>
            </div>
            <div class = "col-md-3 move-down">                
                 <div id="pie" style="height:350px;"></div>
                 <div id="pie-title" style="text-align:center">Your Recent Nutrition Intake.</div>
            </div>
            
            <div class = "col-md-3 move-down">
                <div class="panel panel-default">
                  <div class="panel-heading">My Recent Recipe</div>
                  <div class="panel-body">
                    <ul class="list-group">
                      <li class="list-group-item list-group-item-success"><a href = "#">Chicken Piccata with Pasta</a></li>
                      <li class="list-group-item list-group-item-info"><a href = "#">Milk & Bread</a></li>
                      <li class="list-group-item list-group-item-warning"><a href = "#">Slow Cooker Chicken Taco Soup</a></li>
                      <li class="list-group-item list-group-item-danger"><a href = "#">Baked Teriyaki Chicken</a></li>
                      <li class="list-group-item list-group-item-info"><a href = "#">Milk & Bread</a></li>
                      <li class="list-group-item list-group-item-warning"><a href = "#">Slow Cooker Chicken Taco Soup</a></li>
                      <li class="list-group-item list-group-item-danger"><a href = "#">Baked Teriyaki Chicken</a></li>
                    </ul>
                  </div>
                </div>
            </div>
        </div>
        <div class="bg-white" style="height:500px;">
            
        </div>
	</div> 
<script>				  					 
    //hljs.initHighlightingOnLoad();
    d3.json('data/calorie.json', function(data) {
        //var newData = MG.convert.date(data,'date');
        MG.data_graphic({
            data: data,
            width: 450,
            height: 270,
            target: '#calorie',
            x_accessor: 'date',
            y_accessor: 'Value',
            x_label:'date time',
            y_label:'calorie',
            color_range:['gray', 'black'],
        })
    });
    
    d3.json('data/fat.json', function(data) {
        
        MG.data_graphic({
            data: data,
            width: 450,
            height: 270,
            target: '#fat',
            x_accessor: 'Day',
            y_accessor: 'Value',
            x_label:'date time',
            y_label:'gram',
        })
    });
    
    d3.json('data/surger.json', function(data) {
        MG.data_graphic({
            data: data,
            width: 450,
            height: 270,
            target: '#surger',
            x_accessor: 'Day',
            y_accessor: 'Value',
            x_label:'date time',
            y_label:'gram',
        })
    });
    
    d3.json('data/protein.json', function(data) {
        MG.data_graphic({
            data: data,
            width: 450,
            height: 270,
            target: '#protein',
            x_accessor: 'Day',
            y_accessor: 'Value',
            x_label:'date time',
            y_label:'gram',
        })
    });
</script>	  
<script>

var svg = d3.select("#pie")
	.append("svg")
	.append("g")

svg.append("g")
	.attr("class", "slices");
svg.append("g")
	.attr("class", "labels");
svg.append("g")
	.attr("class", "lines");

var width = 960,
    height = 450,
	radius = Math.min(width, height) / 5.3;

var pie = d3.layout.pie()
	.sort(null)
	.value(function(d) {
		return d.value;
	});

var arc = d3.svg.arc()
	.outerRadius(radius * 0.8)
	.innerRadius(radius * 0.4);

var outerArc = d3.svg.arc()
	.innerRadius(radius * 0.9)
	.outerRadius(radius * 0.9);

svg.attr("transform", "translate(" + width / 6 + "," + height / 2.5 + ")");

var key = function(d){ return d.data.label; };

var color = d3.scale.ordinal()
	.range(["#8a89a6", "#7b6888", "#a05d56", "#ff8c00"]);


var dataArr = [{label:"fat 20%", value:"0.2"},{label:"Carbs 15%", value:"0.15"},{label:"protein 30%", value:"0.3"},{label:"others 5%", value:"0.05"}]
change(dataArr);

d3.select(".randomize")
	.on("click", function(){
		change(randomData());
	});


function change(data) {

	/* ------- PIE SLICES -------*/
	var slice = svg.select(".slices").selectAll("path.slice")
		.data(pie(data), key);

	slice.enter()
		.insert("path")
		.style("fill", function(d) { return color(d.data.label); })
		.attr("class", "slice");

	slice		
		.transition().duration(1000)
		.attrTween("d", function(d) {
			this._current = this._current || d;
			var interpolate = d3.interpolate(this._current, d);
			this._current = interpolate(0);
			return function(t) {
				return arc(interpolate(t));
			};
		})

	slice.exit()
		.remove();

	/* ------- TEXT LABELS -------*/

	var text = svg.select(".labels").selectAll("text")
		.data(pie(data), key);

	text.enter()
		.append("text")
		.attr("dy", ".35em")
		.text(function(d) {
			return d.data.label;
		});
	
	function midAngle(d){
		return d.startAngle + (d.endAngle - d.startAngle)/2;
	}

	text.transition().duration(1000)
		.attrTween("transform", function(d) {
			this._current = this._current || d;
			var interpolate = d3.interpolate(this._current, d);
			this._current = interpolate(0);
			return function(t) {
				var d2 = interpolate(t);
				var pos = outerArc.centroid(d2);
				pos[0] = radius * (midAngle(d2) < Math.PI ? 1 : -1);
				return "translate("+ pos +")";
			};
		})
		.styleTween("text-anchor", function(d){
			this._current = this._current || d;
			var interpolate = d3.interpolate(this._current, d);
			this._current = interpolate(0);
			return function(t) {
				var d2 = interpolate(t);
				return midAngle(d2) < Math.PI ? "start":"end";
			};
		});

	text.exit()
		.remove();

	/* ------- SLICE TO TEXT POLYLINES -------*/

	var polyline = svg.select(".lines").selectAll("polyline")
		.data(pie(data), key);
	
	polyline.enter()
		.append("polyline");

	polyline.transition().duration(1000)
		.attrTween("points", function(d){
			this._current = this._current || d;
			var interpolate = d3.interpolate(this._current, d);
			this._current = interpolate(0);
			return function(t) {
				var d2 = interpolate(t);
				var pos = outerArc.centroid(d2);
				pos[0] = radius * 0.95 * (midAngle(d2) < Math.PI ? 1 : -1);
				return [arc.centroid(d2), outerArc.centroid(d2), pos];
			};			
		});
	
	polyline.exit()
		.remove();
};

</script>  
</body>
</html>